<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Some thoughts (and simulation) on overfitting &#8211; Sebastian Sauer Blog</title>
<meta name="description" content="A blog about research methods, with a focus on data analysis and psychology.">
<meta name="keywords" content="stats, simulation, rstats">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sebastiansauer.github.io/images/">
<meta name="twitter:title" content="Some thoughts (and simulation) on overfitting">
<meta name="twitter:description" content="A blog about research methods, with a focus on data analysis and psychology.">
<meta name="twitter:creator" content="@sauer_sebastian">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Some thoughts (and simulation) on overfitting">
<meta property="og:description" content="A blog about research methods, with a focus on data analysis and psychology.">
<meta property="og:url" content="https://sebastiansauer.github.io/overfitting_simulation/">
<meta property="og:site_name" content="Sebastian Sauer Blog">





<link rel="canonical" href="https://sebastiansauer.github.io/overfitting_simulation/">
<link href="https://sebastiansauer.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Sebastian Sauer Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://sebastiansauer.github.io/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="https://sebastiansauer.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://sebastiansauer.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://sebastiansauer.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://sebastiansauer.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://sebastiansauer.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://sebastiansauer.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://sebastiansauer.github.io/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="https://sebastiansauer.github.io/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="https://sebastiansauer.github.io/images/ses_201102_xsmall.jpg" alt="Sebastian Sauer photo" class="author-photo">
					<h4>Sebastian Sauer</h4>
					<p>Professor at FOM University of Applied Sciences. Thinker on own peril.</p>
				</li>
				<li><a href="https://sebastiansauer.github.io/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:ssauer@posteo.de"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/sauer_sebastian"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				
				<li>
					<a href="https://linkedin.com/in/https://www.linkedin.com/in/dr-sebastian-sauer-4791762"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/sebastiansauer"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				<li>
					<a href="http://stackoverflow.com/users/4434263/sebastian-sauer"><i class="fa fa-fw fa-stack-exchange"></i> Stackexchange</a>
				</li>
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="https://sebastiansauer.github.io/posts/">All Posts</a></li>
				<li><a href="https://sebastiansauer.github.io/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="https://sebastiansauer.github.io/overfitting_simulation/" rel="bookmark" title="Some thoughts (and simulation) on overfitting">Some thoughts (and simulation) on overfitting</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2016-11-12T11:00:00-05:00">November 12, 2016</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~13 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Overfitting is a common problem in data analysis. Some go as far as saying that “most of” published research is false (John Ionnadis); overfitting being one, maybe central, problem of it. In this post, we explore some aspects on the notion of overfitting.</p>

<p>Assume we have 10 metric variables <code class="highlighter-rouge">v</code> (personality/health/behavior/gene indicator variables), and, say, 10 variables for splitting up subgroups (aged vs. young, female vs. male, etc.), so 10 dichotomic variables. Further assume there are no association whatsoever between these variables. How likely is it we find something publishable? Apparently quite probably; but let’s give it a try.</p>

<p>Load some packages.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">corrr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">broom</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">htmlTable</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<h1 id="simulated-dataset-10x10">Simulated dataset 10x10</h1>
<p>Make sup some uncorrelated data, 10x10 variables each <script type="math/tex">N \sim (0,1)</script>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">matrix</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">),</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="w">
</span></code></pre>
</div>

<p>Let’s visualize the correlation matrix.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">correlate</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">rearrange</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">rplot</span><span class="p">(</span><span class="n">print_cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/corr_matrix_1-1.png" alt="plot of chunk corr_matrix_1" /></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">correlate</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v_corr_matrix</span><span class="w">
</span></code></pre>
</div>

<p>So, quite some music in the bar. Let’s look at the distribution of the correlation coefficients.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v_corr_matrix</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">rowname</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">.</span><span class="p">))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v_long</span><span class="w">
  
</span><span class="n">v_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">r_binned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cut_width</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r_binned</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/corr_distrib-1.png" alt="plot of chunk corr_distrib" /></p>

<p>What about common statistics?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span><span class="w">
</span><span class="n">describe</span><span class="p">(</span><span class="n">v_long</span><span class="o">$</span><span class="n">value</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    vars  n  mean   sd median trimmed  mad   min  max range skew kurtosis
## X1    1 90 -0.03 0.36  -0.12   -0.05 0.35 -0.68 0.77  1.44 0.36    -0.68
##      se
## X1 0.04
</code></pre>
</div>

<p>Probably more stringent to just choose one triangle from the matrix, but I think it does not really matter for our purposes.</p>

<p>Quite a bit of substantial correlation going on. Let’s look from a different angle.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_violin</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_jitter</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">v_long</span><span class="o">$</span><span class="n">value</span><span class="p">),</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dashed"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#880011"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/violin_plot-1.png" alt="plot of chunk violin_plot" /></p>

<h2 id="x100-dataset-correlation">100x100 dataset correlation</h2>

<p>Now let’s scale up a bit and see whether the pattern stabilize.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">matrix</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">2</span><span class="w">
</span><span class="n">v</span><span class="m">2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">correlate</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">2</span><span class="err">_</span><span class="n">corr_matrix</span><span class="w">
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="m">2</span><span class="err">_</span><span class="n">corr_matrix</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">rowname</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">.</span><span class="p">))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">2</span><span class="err">_</span><span class="n">long</span><span class="w">
  
</span><span class="n">v</span><span class="m">2</span><span class="err">_</span><span class="n">long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">r_binned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cut_width</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r_binned</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">..count..</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">..count..</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"proportion"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/histo1-1.png" alt="plot of chunk histo1" /></p>

<p>So, how many r’s are in the (0.1,0.3) bin?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">broom</span><span class="p">)</span><span class="w">
</span><span class="n">v</span><span class="m">2</span><span class="err">_</span><span class="n">long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">r_binned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cut_width</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">r_binned</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">n_per_bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w">
            </span><span class="n">prop_per_bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">n</span><span class="p">()</span><span class="o">/</span><span class="n">nrow</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## # A tibble: 5 × 3
##      r_binned n_per_bin prop_per_bin
##        &lt;fctr&gt;     &lt;int&gt;        &lt;dbl&gt;
## 1 [-0.5,-0.3]        10         0.00
## 2 (-0.3,-0.1]      1594         0.16
## 3  (-0.1,0.1]      6776         0.68
## 4   (0.1,0.3]      1512         0.15
## 5   (0.3,0.5]         8         0.00
</code></pre>
</div>

<p>That’s quite a bit; 15% correlation in the bin (.1.3). Publication ahead!</p>

<h1 id="subgroup-analyses">Subgroup analyses</h1>

<p>Now, let’s look at our subgroup. For that purposes, we need actual data, not only the correlation data. Let’s come up with 1000 individuals, where he have 100 measurement (metric; N(0,1)), and 100 subgroup variables (dichotomic).</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">matrix</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="o">*</span><span class="m">100</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">3</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">v</span><span class="m">3</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1000  100
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">matrix</span><span class="p">(</span><span class="n">sample</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span><span class="w"> </span><span class="s2">"B"</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">4</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">v</span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1000  100
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="m">5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">v</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">v</span><span class="m">5</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1000  200
</code></pre>
</div>

<p>Now, t-test battle. For each variable, compute a t-test; for each subgroup, compute a t-test. Do the whole shabeng (100*100 tests).</p>

<p>But, as a first step, let’s look at the first subgroup variable only.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="m">3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">data.frame</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">map</span><span class="p">(</span><span class="o">~</span><span class="n">t.test</span><span class="p">(</span><span class="n">.x</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">v</span><span class="m">4</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">]))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">map</span><span class="p">(</span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">map</span><span class="p">(</span><span class="s2">"p.value"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">unlist</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">tibble</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">v</span><span class="m">3</span><span class="err">_</span><span class="n">pvalues</span><span class="w">

</span><span class="n">v</span><span class="m">3</span><span class="err">_</span><span class="n">pvalues</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">qplot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"p value"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.05</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#880011"</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dashed"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Don't know how to automatically pick scale for object of type tbl_df/tbl/data.frame. Defaulting to continuous.
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/shabeng_1st-1.png" alt="plot of chunk shabeng_1st" /></p>

<p>How many significant p values resulted (should be 5%, ie 5 of 100)?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">v</span><span class="m">3</span><span class="err">_</span><span class="n">pvalues</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">.05</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## # A tibble: 5 × 1
##            .
##        &lt;dbl&gt;
## 1 0.01350926
## 2 0.04115726
## 3 0.01064116
## 4 0.04251559
## 5 0.02505199
</code></pre>
</div>

<p>Which is exactly what we found.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w">
</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">){</span><span class="w">
  
  </span><span class="n">v</span><span class="m">3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">data.frame</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">map</span><span class="p">(</span><span class="o">~</span><span class="n">t.test</span><span class="p">(</span><span class="n">.x</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">v</span><span class="m">4</span><span class="p">[,</span><span class="w"> </span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">map</span><span class="p">(</span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">map</span><span class="p">(</span><span class="s2">"p.value"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">unlist</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">tibble</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">p_list</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">
  
</span><span class="p">}</span><span class="w">

</span><span class="c1"># str(p_list)  #tl;dr
</span><span class="w">
</span><span class="n">p_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">p_list</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">p_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"V"</span><span class="p">,</span><span class="w"> </span><span class="n">formatC</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"0"</span><span class="p">),</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Let’s try a giant plot with 100 small multiples.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_histogram</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/giant_plot-1.png" alt="plot of chunk giant_plot" /></p>

<p>Well impressive, but that histogram matrix does not serve much. What about a correlation plot as above, only giantesque…</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">correlate</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">rplot</span><span class="w">
</span></code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/corr_plot_giant-1.png" alt="plot of chunk corr_plot_giant" /></p>

<p>Hm, of artis values (in 10000 years). Maybe better plot a histogram of the number of signifinat p-values ( &lt;. 05).</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">dplyr</span><span class="o">::</span><span class="n">filter</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">.05</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">qplot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"p value"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/hist3-1.png" alt="plot of chunk hist3" /></p>

<p>In exact numbers, what’s the percentage of significant p-values per variable?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">.05</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">p_significant</span><span class="w">
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">htmlTable</span><span class="p">(</span><span class="n">p_significant</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"> </th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">key</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: center;">V001</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: center;">V002</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: center;">V003</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: center;">V004</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: center;">V005</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">6</td>
<td style="text-align: center;">V006</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: center;">V007</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">8</td>
<td style="text-align: center;">V008</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">9</td>
<td style="text-align: center;">V009</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">10</td>
<td style="text-align: center;">V010</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">11</td>
<td style="text-align: center;">V011</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">12</td>
<td style="text-align: center;">V012</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">13</td>
<td style="text-align: center;">V013</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">14</td>
<td style="text-align: center;">V014</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">15</td>
<td style="text-align: center;">V015</td>
<td style="text-align: center;">13</td>
</tr>
<tr>
<td style="text-align: left;">16</td>
<td style="text-align: center;">V016</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">17</td>
<td style="text-align: center;">V017</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">18</td>
<td style="text-align: center;">V018</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">19</td>
<td style="text-align: center;">V019</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">20</td>
<td style="text-align: center;">V020</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">21</td>
<td style="text-align: center;">V021</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: left;">22</td>
<td style="text-align: center;">V022</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">23</td>
<td style="text-align: center;">V023</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">24</td>
<td style="text-align: center;">V024</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">25</td>
<td style="text-align: center;">V025</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">26</td>
<td style="text-align: center;">V026</td>
<td style="text-align: center;">9</td>
</tr>
<tr>
<td style="text-align: left;">27</td>
<td style="text-align: center;">V027</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">28</td>
<td style="text-align: center;">V028</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">29</td>
<td style="text-align: center;">V029</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">30</td>
<td style="text-align: center;">V030</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">31</td>
<td style="text-align: center;">V031</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">32</td>
<td style="text-align: center;">V032</td>
<td style="text-align: center;">9</td>
</tr>
<tr>
<td style="text-align: left;">33</td>
<td style="text-align: center;">V033</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">34</td>
<td style="text-align: center;">V034</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">35</td>
<td style="text-align: center;">V035</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">36</td>
<td style="text-align: center;">V036</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">37</td>
<td style="text-align: center;">V037</td>
<td style="text-align: center;">11</td>
</tr>
<tr>
<td style="text-align: left;">38</td>
<td style="text-align: center;">V038</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">39</td>
<td style="text-align: center;">V039</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">40</td>
<td style="text-align: center;">V040</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: left;">41</td>
<td style="text-align: center;">V041</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">42</td>
<td style="text-align: center;">V042</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">43</td>
<td style="text-align: center;">V043</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">44</td>
<td style="text-align: center;">V044</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">45</td>
<td style="text-align: center;">V045</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">46</td>
<td style="text-align: center;">V046</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">47</td>
<td style="text-align: center;">V047</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">48</td>
<td style="text-align: center;">V048</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">49</td>
<td style="text-align: center;">V049</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">50</td>
<td style="text-align: center;">V050</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">51</td>
<td style="text-align: center;">V051</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">52</td>
<td style="text-align: center;">V052</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: left;">53</td>
<td style="text-align: center;">V053</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">54</td>
<td style="text-align: center;">V054</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">55</td>
<td style="text-align: center;">V055</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">56</td>
<td style="text-align: center;">V056</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">57</td>
<td style="text-align: center;">V057</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">58</td>
<td style="text-align: center;">V058</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">59</td>
<td style="text-align: center;">V059</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: left;">60</td>
<td style="text-align: center;">V060</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">61</td>
<td style="text-align: center;">V062</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">62</td>
<td style="text-align: center;">V063</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">63</td>
<td style="text-align: center;">V064</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">64</td>
<td style="text-align: center;">V065</td>
<td style="text-align: center;">12</td>
</tr>
<tr>
<td style="text-align: left;">65</td>
<td style="text-align: center;">V066</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">66</td>
<td style="text-align: center;">V067</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">67</td>
<td style="text-align: center;">V068</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">68</td>
<td style="text-align: center;">V069</td>
<td style="text-align: center;">9</td>
</tr>
<tr>
<td style="text-align: left;">69</td>
<td style="text-align: center;">V070</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">70</td>
<td style="text-align: center;">V071</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">71</td>
<td style="text-align: center;">V072</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">72</td>
<td style="text-align: center;">V073</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">73</td>
<td style="text-align: center;">V074</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: left;">74</td>
<td style="text-align: center;">V075</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">75</td>
<td style="text-align: center;">V076</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">76</td>
<td style="text-align: center;">V077</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">77</td>
<td style="text-align: center;">V078</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">78</td>
<td style="text-align: center;">V079</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">79</td>
<td style="text-align: center;">V080</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">80</td>
<td style="text-align: center;">V081</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">81</td>
<td style="text-align: center;">V082</td>
<td style="text-align: center;">9</td>
</tr>
<tr>
<td style="text-align: left;">82</td>
<td style="text-align: center;">V083</td>
<td style="text-align: center;">12</td>
</tr>
<tr>
<td style="text-align: left;">83</td>
<td style="text-align: center;">V084</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">84</td>
<td style="text-align: center;">V085</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: left;">85</td>
<td style="text-align: center;">V086</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">86</td>
<td style="text-align: center;">V087</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">87</td>
<td style="text-align: center;">V088</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">88</td>
<td style="text-align: center;">V089</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">89</td>
<td style="text-align: center;">V090</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">90</td>
<td style="text-align: center;">V091</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">91</td>
<td style="text-align: center;">V092</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">92</td>
<td style="text-align: center;">V093</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">93</td>
<td style="text-align: center;">V094</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: left;">94</td>
<td style="text-align: center;">V095</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">95</td>
<td style="text-align: center;">V096</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: left;">96</td>
<td style="text-align: center;">V097</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: left;">97</td>
<td style="text-align: center;">V098</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: left;">98</td>
<td style="text-align: center;">V099</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">99</td>
<td style="border-bottom: 2px solid grey; text-align: center;">V100</td>
<td style="border-bottom: 2px solid grey; text-align: center;">2</td>
</tr>
</tbody>
</table>

<p>Distribution of significant p-values.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_significant</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">qplot</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
</div>

<p><img src="https://sebastiansauer.github.io/images/2016-11-13/histo_p_values-1.png" alt="plot of chunk histo_p_values" /></p>

<p>Summary stats of significant p-values.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">.05</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">n_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w">
            </span><span class="n">mean_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">value</span><span class="p">),</span><span class="w">
            </span><span class="n">median_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">value</span><span class="p">),</span><span class="w">
            </span><span class="n">sd_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">IQP_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IQR</span><span class="p">(</span><span class="n">value</span><span class="p">),</span><span class="w">
            </span><span class="n">min_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">value</span><span class="p">),</span><span class="w">
            </span><span class="n">max_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">map</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">as.data.frame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">p_summary_tab</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Warning in mean.default(.x[[i]], ...): argument is not numeric or logical:
## returning NA
</code></pre>
</div>

<p>Here comes the table of the <em>mean</em> over all 100 variables of the typical statistics.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">p_summary_tab</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">round</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">htmlTable</span><span class="w">
</span></code></pre>
</div>

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"> </th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">key</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">n_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">mean_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">median_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">sd_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">IQP_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">min_p</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">max_p</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">1</td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td>
<td style="border-bottom: 2px solid grey; text-align: center;">6</td>
<td style="border-bottom: 2px solid grey; text-align: center;">0</td>
<td style="border-bottom: 2px solid grey; text-align: center;">0</td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td>
<td style="border-bottom: 2px solid grey; text-align: center;">0</td>
<td style="border-bottom: 2px solid grey; text-align: center;">0</td>
<td style="border-bottom: 2px solid grey; text-align: center;">0</td>
</tr>
</tbody>
</table>

<p>In sum, overfitting - mistakenly taking noise as signal - happened often. Actually, as often as is expected by theory. But, not knowing or not minding theory, one can easily be surprised by the plethora of “interesting findings” in the data. In John Tukey’s words (more or less): “Torture the data for a long enough time and it will tell you anything”.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="https://sebastiansauer.github.io/tags/#stats" title="Pages tagged stats" class="tag"><span class="term">stats</span></a><a href="https://sebastiansauer.github.io/tags/#simulation" title="Pages tagged simulation" class="tag"><span class="term">simulation</span></a><a href="https://sebastiansauer.github.io/tags/#rstats" title="Pages tagged rstats" class="tag"><span class="term">rstats</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://sebastiansauer.github.io/overfitting_simulation/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=https://sebastiansauer.github.io/overfitting_simulation/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=https://sebastiansauer.github.io/overfitting_simulation/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="https://sebastiansauer.github.io/plotting_surveys/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="https://sebastiansauer.github.io/improved_bar_stacking_ggplot2_220/" title="New bar stacking with ggplot 2.2.0">New bar stacking with ggplot 2.2.0</a></h3>
      <p>Recently, `ggplot2` 2.2.0 was released. Among other news, stacking bar plot was improved. Here is a short demonstration.Load libraries```...&hellip; <a href="https://sebastiansauer.github.io/improved_bar_stacking_ggplot2_220/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="https://sebastiansauer.github.io/Crashkurs_Barplots/" title="Crashkurs zur Erstellung von Barplots für Umfrage-Daten">Crashkurs zur Erstellung von Barplots für Umfrage-Daten</a></h4>
        <span>Published on November 13, 2016</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="https://sebastiansauer.github.io/plotting_surveys/" title="Preparing and plotting survey results">Preparing and plotting survey results</a></h4>
        <span>Published on November 10, 2016</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Sebastian Sauer. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://sebastiansauer.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://sebastiansauer.github.io/assets/js/scripts.min.js"></script>

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



	        

</body>
</html>
